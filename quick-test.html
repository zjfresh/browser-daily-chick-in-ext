<!DOCTYPE html>
<html>
<head>
    <title>å¿«é€Ÿæµ‹è¯• - testConfigä¿®å¤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 15px; margin: 5px; }
        .log { background: #f5f5f5; padding: 10px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px; }
        .result { padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª å¿«é€Ÿæµ‹è¯• - testConfigä¿®å¤</h1>
    
    <p>è¿™ä¸ªé¡µé¢æµ‹è¯•ä¿®å¤åçš„testConfigåŠŸèƒ½æ˜¯å¦æ­£ç¡®æ›´æ–°è§¦å‘è®°å½•ã€‚</p>
    
    <div>
        <button onclick="testBasicSetLastOpenDate()">æµ‹è¯•åŸºç¡€setLastOpenDate</button>
        <button onclick="testSetWithUndefined()">æµ‹è¯•ä¼ å…¥undefined</button>
        <button onclick="testSetWithNull()">æµ‹è¯•ä¼ å…¥nullï¼ˆåˆ é™¤ï¼‰</button>
        <button onclick="testSetWithDate()">æµ‹è¯•ä¼ å…¥å…·ä½“æ—¥æœŸ</button>
        <button onclick="simulateTestConfig()">æ¨¡æ‹ŸtestConfigè°ƒç”¨</button>
    </div>
    
    <div>
        <h3>ç»“æœï¼š</h3>
        <div id="result" class="result"></div>
    </div>
    
    <div>
        <h3>æ—¥å¿—ï¼š</h3>
        <button onclick="clearLogs()">æ¸…ç©ºæ—¥å¿—</button>
        <div id="logs" class="log"></div>
    </div>

    <script>
        // æ‹¦æˆªconsole.log
        const originalLog = console.log;
        const originalError = console.error;
        
        function addLogToPage(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const logDiv = document.getElementById('logs');
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${timestamp}] ${message}`;
            logEntry.style.color = type === 'error' ? 'red' : 'black';
            logDiv.appendChild(logEntry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLogToPage(args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLogToPage('ERROR: ' + args.join(' '), 'error');
        };

        const resultDiv = document.getElementById('result');
        
        async function testBasicSetLastOpenDate() {
            try {
                console.log('=== æµ‹è¯•åŸºç¡€setLastOpenDate ===');
                
                const testId = 'quick_test_' + Date.now();
                console.log(`ä½¿ç”¨æµ‹è¯•ID: ${testId}`);
                
                // ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼Œåº”è¯¥è®¾ç½®ä¸ºä»Šå¤©
                await Utils.setLastOpenDate(testId);
                
                // è¯»å–éªŒè¯
                const result = await Utils.getLastOpenDate(testId);
                console.log(`è¯»å–ç»“æœ: ${result}`);
                console.log(`ä»Šå¤©æ˜¯: ${Utils.getTodayString()}`);
                
                const isSuccess = result === Utils.getTodayString();
                resultDiv.innerHTML = `åŸºç¡€æµ‹è¯•${isSuccess ? 'âœ…æˆåŠŸ' : 'âŒå¤±è´¥'}: ${testId} = ${result}`;
                
            } catch (error) {
                console.error('åŸºç¡€æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `âŒåŸºç¡€æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }

        async function testSetWithUndefined() {
            try {
                console.log('=== æµ‹è¯•ä¼ å…¥undefined ===');
                
                const testId = 'undefined_test_' + Date.now();
                console.log(`ä½¿ç”¨æµ‹è¯•ID: ${testId}`);
                
                // æ˜ç¡®ä¼ å…¥undefined
                await Utils.setLastOpenDate(testId, undefined);
                
                const result = await Utils.getLastOpenDate(testId);
                console.log(`è¯»å–ç»“æœ: ${result}`);
                
                const isSuccess = result === Utils.getTodayString();
                resultDiv.innerHTML = `undefinedæµ‹è¯•${isSuccess ? 'âœ…æˆåŠŸ' : 'âŒå¤±è´¥'}: ${testId} = ${result}`;
                
            } catch (error) {
                console.error('undefinedæµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `âŒundefinedæµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }

        async function testSetWithNull() {
            try {
                console.log('=== æµ‹è¯•ä¼ å…¥nullï¼ˆåˆ é™¤ï¼‰ ===');
                
                const testId = 'null_test_' + Date.now();
                console.log(`ä½¿ç”¨æµ‹è¯•ID: ${testId}`);
                
                // å…ˆè®¾ç½®ä¸€ä¸ªå€¼
                await Utils.setLastOpenDate(testId, '2024-01-01');
                console.log('å…ˆè®¾ç½®å€¼ä¸º: 2024-01-01');
                
                // ä¼ å…¥nullåˆ é™¤
                await Utils.setLastOpenDate(testId, null);
                console.log('ä¼ å…¥nullåˆ é™¤');
                
                const result = await Utils.getLastOpenDate(testId);
                console.log(`åˆ é™¤åè¯»å–ç»“æœ: ${result}`);
                
                const isSuccess = result === null;
                resultDiv.innerHTML = `nullåˆ é™¤æµ‹è¯•${isSuccess ? 'âœ…æˆåŠŸ' : 'âŒå¤±è´¥'}: ${testId} = ${result}`;
                
            } catch (error) {
                console.error('nullæµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `âŒnullæµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }

        async function testSetWithDate() {
            try {
                console.log('=== æµ‹è¯•ä¼ å…¥å…·ä½“æ—¥æœŸ ===');
                
                const testId = 'date_test_' + Date.now();
                const testDate = '2024-12-25';
                console.log(`ä½¿ç”¨æµ‹è¯•ID: ${testId}`);
                console.log(`ä½¿ç”¨æµ‹è¯•æ—¥æœŸ: ${testDate}`);
                
                await Utils.setLastOpenDate(testId, testDate);
                
                const result = await Utils.getLastOpenDate(testId);
                console.log(`è¯»å–ç»“æœ: ${result}`);
                
                const isSuccess = result === testDate;
                resultDiv.innerHTML = `å…·ä½“æ—¥æœŸæµ‹è¯•${isSuccess ? 'âœ…æˆåŠŸ' : 'âŒå¤±è´¥'}: ${testId} = ${result}`;
                
            } catch (error) {
                console.error('å…·ä½“æ—¥æœŸæµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `âŒå…·ä½“æ—¥æœŸæµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }

        async function simulateTestConfig() {
            try {
                console.log('=== æ¨¡æ‹ŸtestConfigè°ƒç”¨ ===');
                
                const testConfig = {
                    id: 'simulate_test_' + Date.now(),
                    url: 'https://example.com',
                    mode: 'toast',
                    note: 'æ¨¡æ‹Ÿæµ‹è¯•é…ç½®'
                };
                
                console.log('æ¨¡æ‹Ÿé…ç½®:', testConfig);
                
                // æ¨¡æ‹ŸtestConfigä¸­çš„è°ƒç”¨ï¼šUtils.setLastOpenDate(config.id)
                console.log('è°ƒç”¨ Utils.setLastOpenDate(config.id) - ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°');
                await Utils.setLastOpenDate(testConfig.id);
                
                const result = await Utils.getLastOpenDate(testConfig.id);
                console.log(`è¯»å–ç»“æœ: ${result}`);
                
                const isSuccess = result === Utils.getTodayString();
                resultDiv.innerHTML = `testConfigæ¨¡æ‹Ÿ${isSuccess ? 'âœ…æˆåŠŸ' : 'âŒå¤±è´¥'}: ${testConfig.id} = ${result}`;
                
            } catch (error) {
                console.error('testConfigæ¨¡æ‹Ÿå¤±è´¥:', error);
                resultDiv.innerHTML = `âŒtestConfigæ¨¡æ‹Ÿå¤±è´¥: ${error.message}`;
            }
        }

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }

        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', () => {
            console.log('ğŸ§ª å¿«é€Ÿæµ‹è¯•é¡µé¢å·²åŠ è½½');
            if (!window.Utils) {
                resultDiv.innerHTML = 'âŒ Utilsä¸å¯ç”¨ï¼Œè¯·ç¡®ä¿æ‰©å±•å·²æ­£ç¡®åŠ è½½';
            }
        });
    </script>
</body>
</html> 